---
import PageLayout from '@layouts/PageLayout.astro';
import Card from '@components/ui/Card.astro';
import { getCollection } from 'astro:content';

const allCaseStudies = await getCollection('case-studies');
const sortedCaseStudies = allCaseStudies.sort(
  (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime()
);
---

<PageLayout
  title="Case Studies"
  description="Real-world implementations of iTowns across research, government, and commercial organizations."
>
  <div class="case-studies-page">
    <div class="container">
      <header class="page-header">
        <h1>Case Studies</h1>
        <p class="page-description">
          Organizations building critical 3D geospatial systems with iTowns.
        </p>
      </header>

      {
        sortedCaseStudies.length > 0 ? (
          <div class="case-studies-grid">
            {sortedCaseStudies.map((study) => (
              <Card href={`/case-studies/${study.slug}`}>
                <article>
                  <h2>{study.data.organization}</h2>
                  <p class="industry">{study.data.industry}</p>
                  <p class="use-case">{study.data.useCase}</p>
                  <p class="outcome">
                    <strong>Outcome:</strong> {study.data.outcome}
                  </p>
                </article>
              </Card>
            ))}
          </div>
        ) : (
          <p class="no-content">
            Case studies coming soon. Check back later!
          </p>
        )
      }
    </div>
  </div>
</PageLayout>

<style>
  .case-studies-page {
    padding: var(--space-8) 0;
  }

  .page-header {
    text-align: center;
    max-width: 700px;
    margin: 0 auto var(--space-8);
  }

  .page-description {
    font-size: var(--text-lg);
    color: var(--color-text-secondary);
  }

  .case-studies-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: var(--space-5);
  }

  article h2 {
    font-size: var(--text-xl);
    margin-bottom: var(--space-2);
  }

  .industry {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
    text-transform: capitalize;
    margin-bottom: var(--space-3);
  }

  .use-case {
    font-size: var(--text-base);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-3);
    line-height: var(--leading-relaxed);
  }

  .outcome {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
  }

  .no-content {
    text-align: center;
    color: var(--color-text-tertiary);
    font-size: var(--text-lg);
    padding: var(--space-8) 0;
  }

  @media (max-width: 768px) {
    .case-studies-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

