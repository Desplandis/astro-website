---
import PageLayout from '@layouts/PageLayout.astro';
import Button from '@components/ui/Button.astro';
import Card from '@components/ui/Card.astro';
import { getCollection } from 'astro:content';

// Get featured case studies
const allCaseStudies = await getCollection('case-studies');
const featuredCaseStudies = allCaseStudies
  .filter((study) => study.data.featured)
  .slice(0, 3);
---

<PageLayout
  title="iTowns"
  description="A framework for 3D geospatial web applications. Built as a commons, governed by its users. Open-source, standards-based, production-ready."
>
  <!-- Hero Section -->
  <section class="hero">
    <div class="container">
      <h1 class="hero-title">
        A Framework for 3D Geospatial Web Applications
      </h1>
      <p class="hero-subtitle">
        Built as a commons, governed by its users. Open-source,
        standards-based, production-ready.
      </p>
      <div class="hero-actions">
        <Button href="/docs/getting-started" variant="primary" size="lg">
          Get Started →
        </Button>
        <Button href="/about" variant="outline" size="lg">Why iTowns?</Button>
      </div>

      <ul class="hero-facts">
        <li>Built on open standards (OGC, WMS, WMTS, 3D Tiles)</li>
        <li>Used in production by research and government organizations</li>
        <li>Maintained by a commons governance model</li>
        <li>Apache 2.0 licensed</li>
      </ul>
    </div>
  </section>

  <!-- Value Propositions -->
  <section class="values">
    <div class="container">
      <div class="value-section">
        <div class="value-content">
          <h2>Build Without Lock-In</h2>
          <p>
            iTowns prioritizes open standards and extensibility. No proprietary
            APIs, no vendor dependencies. Your code remains portable, and your
            data stays yours.
          </p>
          <ul>
            <li>Standards-first architecture (OGC, W3C)</li>
            <li>Extensible plugin system</li>
            <li>Clear migration paths</li>
            <li>Active documentation and examples</li>
          </ul>
          <Button href="/docs" variant="primary">Documentation →</Button>
        </div>
        <div class="value-audience">For Developers</div>
      </div>

      <div class="value-section reverse">
        <div class="value-content">
          <h2>Governed by Users, Built for Longevity</h2>
          <p>
            iTowns operates as a commons. Decision-making is transparent,
            governance is collective, and sustainability is prioritized over
            short-term profits.
          </p>
          <ul>
            <li>Commons governance structure</li>
            <li>Transparent roadmap and decision-making</li>
            <li>Organizational members and contributors</li>
            <li>Long-term sustainability model</li>
          </ul>
          <Button href="/governance" variant="primary"
            >Learn About Governance →</Button
          >
        </div>
        <div class="value-audience">For Decision-Makers</div>
      </div>
    </div>
  </section>

  <!-- Case Studies -->
  {
    featuredCaseStudies.length > 0 && (
      <section class="case-studies">
        <div class="container">
          <h2>Trusted by Organizations Building Critical Systems</h2>
          <div class="case-studies-grid">
            {featuredCaseStudies.map((study) => (
              <Card href={`/case-studies/${study.slug}`}>
                <h3>{study.data.organization}</h3>
                <p class="industry">{study.data.industry}</p>
                <p class="use-case">{study.data.useCase}</p>
                <p class="outcome">
                  <strong>Outcome:</strong> {study.data.outcome}
                </p>
              </Card>
            ))}
          </div>
          <div class="case-studies-cta">
            <Button href="/case-studies" variant="outline"
              >View All Case Studies →</Button
            >
          </div>
        </div>
      </section>
    )
  }

  <!-- Get Started CTA -->
  <section class="cta">
    <div class="container">
      <div class="cta-content">
        <h2>Ready to Get Started?</h2>
        <p>
          Install iTowns, explore the documentation, or join the community
          discussion.
        </p>
        <div class="cta-actions">
          <Button href="/docs/getting-started" variant="primary" size="lg">
            Get Started
          </Button>
          <Button href="/community" variant="outline" size="lg">
            Join the Community
          </Button>
        </div>
      </div>
    </div>
  </section>
</PageLayout>

<style>
  /* Hero */
  .hero {
    padding: var(--space-9) 0 var(--space-8);
    text-align: center;
  }

  .hero-title {
    font-size: var(--text-5xl);
    max-width: 900px;
    margin: 0 auto var(--space-5);
  }

  .hero-subtitle {
    font-size: var(--text-xl);
    color: var(--color-text-secondary);
    max-width: 700px;
    margin: 0 auto var(--space-6);
    line-height: var(--leading-relaxed);
  }

  .hero-actions {
    display: flex;
    gap: var(--space-4);
    justify-content: center;
    margin-bottom: var(--space-7);
  }

  .hero-facts {
    list-style: none;
    margin: 0;
    padding: 0;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: var(--space-4);
    max-width: 1000px;
    margin: 0 auto;
  }

  .hero-facts li {
    padding: var(--space-4);
    background-color: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
  }

  /* Values */
  .values {
    padding: var(--space-9) 0;
    background-color: var(--color-bg-secondary);
  }

  .value-section {
    display: grid;
    grid-template-columns: 3fr 1fr;
    gap: var(--space-7);
    margin-bottom: var(--space-9);
    align-items: start;
  }

  .value-section:last-child {
    margin-bottom: 0;
  }

  .value-section.reverse {
    direction: rtl;
  }

  .value-section.reverse .value-content {
    direction: ltr;
  }

  .value-content h2 {
    margin-bottom: var(--space-4);
  }

  .value-content p {
    font-size: var(--text-lg);
    margin-bottom: var(--space-4);
  }

  .value-content ul {
    margin-bottom: var(--space-5);
  }

  .value-audience {
    font-size: var(--text-sm);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: var(--color-accent-primary);
    padding: var(--space-3);
    background-color: var(--color-bg-primary);
    border-radius: var(--radius-md);
    text-align: center;
  }

  /* Case Studies */
  .case-studies {
    padding: var(--space-9) 0;
  }

  .case-studies h2 {
    text-align: center;
    margin-bottom: var(--space-7);
  }

  .case-studies-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-5);
    margin-bottom: var(--space-6);
  }

  .case-studies-grid h3 {
    font-size: var(--text-xl);
    margin-bottom: var(--space-2);
  }

  .industry {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
    text-transform: capitalize;
    margin-bottom: var(--space-3);
  }

  .use-case {
    font-size: var(--text-base);
    color: var(--color-text-secondary);
    margin-bottom: var(--space-3);
  }

  .outcome {
    font-size: var(--text-sm);
    color: var(--color-text-tertiary);
  }

  .case-studies-cta {
    text-align: center;
  }

  /* CTA */
  .cta {
    padding: var(--space-9) 0;
    background-color: var(--color-bg-secondary);
  }

  .cta-content {
    text-align: center;
    max-width: 700px;
    margin: 0 auto;
  }

  .cta-content h2 {
    margin-bottom: var(--space-4);
  }

  .cta-content p {
    font-size: var(--text-lg);
    margin-bottom: var(--space-6);
  }

  .cta-actions {
    display: flex;
    gap: var(--space-4);
    justify-content: center;
  }

  @media (max-width: 768px) {
    .hero {
      padding: var(--space-7) 0 var(--space-6);
    }

    .hero-actions,
    .cta-actions {
      flex-direction: column;
      align-items: center;
    }

    .value-section,
    .value-section.reverse {
      grid-template-columns: 1fr;
      direction: ltr;
    }

    .case-studies-grid {
      grid-template-columns: 1fr;
    }
  }
</style>

